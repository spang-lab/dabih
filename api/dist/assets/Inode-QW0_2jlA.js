import{u as $,b as h,j as t,r as w,F as g}from"./index-D81WwACb.js";import{I as d}from"./base-CJy2W7aR.js";import b from"./Draggable-DkyZLJaN.js";import j from"./Droppable-JP6NU105.js";import f from"./Icon-BT5RBuHz.js";import{u as v}from"./Context-CTVvxjOO.js";import"./core.esm-DQkDfR73.js";import"./index-BLzTb_JD.js";import"./Spinner-Br-E1HIG.js";import"./folder-BHZ6CSSP.js";import"./trash-2-DYQ5HbAl.js";import"./file-D2EBNl1U.js";import"./copy-BIumn5ZQ.js";function A({inode:n}){const{isAdmin:l,user:m}=$(),{setMenu:x,selected:s,setSelected:r,list:a}=v(),i=h(e=>e.searchStatus),p=h(e=>e.parents),c=[n,...p].some(e=>e.members.some(o=>o.sub===m?.sub)),u=["complete","loading"].includes(i);return t.jsx("div",{className:"h-fit w-32 select-none",onClick:e=>{if(e.preventDefault(),e.stopPropagation(),e.shiftKey||e.metaKey){const o=[...s].filter(N=>N!==n.mnemonic);s.length===o.length&&o.push(n.mnemonic),r(o);return}r([n.mnemonic])},onDoubleClick:()=>{!c&&!l&&!u||a(n.mnemonic)},onContextMenu:e=>{e.preventDefault(),e.stopPropagation(),s.includes(n.mnemonic)||r([n.mnemonic]),x({left:e.clientX,top:e.clientY,open:!0})},children:t.jsx(y,{inode:n,selected:s.includes(n.mnemonic),disabled:!c&&!u})},n.mnemonic)}function y({inode:n,selected:l,disabled:m}){const{rename:x}=v(),[s,r]=w.useState(null),{type:a,mnemonic:i}=n,p=`drag-${i}`,c=`drop-${i}`,u=()=>s?t.jsx("input",{autoFocus:!0,className:"w-full h-full border text-blue border-gray-200",value:s,onChange:e=>r(e.target.value),onFocus:e=>{const o=s.lastIndexOf(".")||s.length;e.target.setSelectionRange(0,o)},onKeyUp:e=>{if(e.stopPropagation(),e.key==="Enter"){if(s===n.name){r(null);return}x(i,s),r(null)}},onKeyDown:e=>{e.stopPropagation()},onBlur:e=>{if(e.stopPropagation(),s===n.name){r(null);return}x(i,s),r(null)}}):t.jsx(g,{fileName:n.name});return a===d.FILE?t.jsx(b,{id:p,children:t.jsxs("div",{className:`flex h-fit flex-col rounded-xl text-blue items-center ${m?"opacity-70":""}`,children:[t.jsx("div",{className:`m-1 rounded-lg ${l?"bg-blue/10":""}`,children:t.jsx(f,{inode:n})}),t.jsx("div",{onDoubleClick:e=>{e.stopPropagation(),r(n.name)},className:`max-w-full px-1 rounded-sm ${l&&!s?"text-white bg-blue/90":""}`,children:u()})]})}):a===d.DIRECTORY?t.jsx(b,{id:p,children:t.jsx(j,{id:c,children:t.jsxs("div",{className:`flex h-fit flex-col rounded-xl text-blue items-center ${m?"opacity-70":""}`,children:[t.jsx("div",{className:`m-1 rounded-lg ${l?"bg-blue/10":""}`,children:t.jsx(f,{inode:n})}),t.jsx("div",{onDoubleClick:e=>{e.stopPropagation(),r(n.name)},className:`max-w-full px-1 rounded-sm ${l?"text-white bg-blue/90":""}`,children:u()})]})})}):a===d.TRASH||a===d.HOME?t.jsx(j,{id:c,children:t.jsxs("div",{className:`flex h-fit flex-col rounded-xl text-blue items-center ${m?"opacity-70":""}`,children:[t.jsx("div",{className:`m-1 relative rounded-lg ${l?"bg-blue/10":""}`,children:t.jsx(f,{inode:n})}),t.jsx("div",{className:`max-w-full px-1 rounded-sm ${l?"text-white bg-blue/90":""}`,children:n.name})]})}):t.jsxs("div",{className:"flex h-fit flex-col rounded-xl text-blue/70 items-center",children:[t.jsx("div",{className:`m-1 relative rounded-lg ${l?"bg-blue/10":""}`,children:t.jsx(f,{inode:n})}),t.jsx("div",{className:`max-w-full px-1 text-[10px] rounded-sm ${l?"text-white bg-blue/90":""}`,children:t.jsx(g,{fileName:n.name})})]})}export{A as default};
