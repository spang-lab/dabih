import{r as u,R as a,P as l,u as w,j as o,a as O,c as h}from"./index-D81WwACb.js";import{E as k,D as E}from"./Error-C9LKrLjX.js";import{C as N}from"./CreateKey-CFeMbgxx.js";import{F as b}from"./file-D2EBNl1U.js";import"./index-CHKqd08H.js";import"./Transition-D4OxtElp.js";import"./dialog-YppJ8AFh.js";import"./portal-CrkO56Jr.js";import"./index-BLzTb_JD.js";import"./description-CHTAMN5B.js";import"./Spinner-Br-E1HIG.js";function m(){return m=Object.assign||function(e){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},m.apply(this,arguments)}function z(e,s){if(e==null)return{};var r=P(e,s),t,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],!(s.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function P(e,s){if(e==null)return{};var r={},t=Object.keys(e),n,i;for(i=0;i<t.length;i++)n=t[i],!(s.indexOf(n)>=0)&&(r[n]=e[n]);return r}var d=u.forwardRef(function(e,s){var r=e.color,t=r===void 0?"currentColor":r,n=e.size,i=n===void 0?24:n,p=z(e,["color","size"]);return a.createElement("svg",m({ref:s,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},p),a.createElement("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",ry:"2"}),a.createElement("rect",{x:"9",y:"9",width:"6",height:"6"}),a.createElement("line",{x1:"9",y1:"1",x2:"9",y2:"4"}),a.createElement("line",{x1:"15",y1:"1",x2:"15",y2:"4"}),a.createElement("line",{x1:"9",y1:"20",x2:"9",y2:"23"}),a.createElement("line",{x1:"15",y1:"20",x2:"15",y2:"23"}),a.createElement("line",{x1:"20",y1:"9",x2:"23",y2:"9"}),a.createElement("line",{x1:"20",y1:"14",x2:"23",y2:"14"}),a.createElement("line",{x1:"1",y1:"9",x2:"4",y2:"9"}),a.createElement("line",{x1:"1",y1:"14",x2:"4",y2:"14"}))});d.propTypes={color:l.string,size:l.oneOfType([l.string,l.number])};d.displayName="Cpu";function y(){return y=Object.assign||function(e){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},y.apply(this,arguments)}function C(e,s){if(e==null)return{};var r=K(e,s),t,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],!(s.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function K(e,s){if(e==null)return{};var r={},t=Object.keys(e),n,i;for(i=0;i<t.length;i++)n=t[i],!(s.indexOf(n)>=0)&&(r[n]=e[n]);return r}var f=u.forwardRef(function(e,s){var r=e.color,t=r===void 0?"currentColor":r,n=e.size,i=n===void 0?24:n,p=C(e,["color","size"]);return a.createElement("svg",y({ref:s,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},p),a.createElement("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.createElement("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"}))});f.propTypes={color:l.string,size:l.oneOfType([l.string,l.number])};f.displayName="Lock";function B(){const{user:e,update:s}=w(),[r,t]=u.useState(null),[n,i]=u.useState(!1);if(!e)return null;const p=async c=>{await O.user.addKey({sub:e.sub,data:{...c},isRootKey:!1}),await s()},g=async c=>{try{const x=await c.text(),j=await h.publicKey.fromFile(x),v=await h.publicKey.toJWK(j);await p(v)}catch(x){if(x instanceof Error){t(x.toString());return}t("Failed to read public key file")}};return o.jsxs("div",{className:"w-full",children:[o.jsx(k,{message:r,onClose:()=>t(null)}),o.jsx(N,{show:n,onClose:()=>i(!1),onSubmit:c=>void p(c)}),o.jsxs("h2",{className:"text-2xl font-extrabold tracking-tight sm:text-3xl md:text-4xl",children:["Add a",o.jsx("span",{className:"text-blue",children:" new "}),"keypair"]}),o.jsxs("div",{className:"lg:grid gap-x-6 grid-cols-2 mt-4",children:[o.jsxs("div",{className:"flex h-80 sm:h-64 m-2 grow items-center flex-col justify-center border-2 rounded-3xl bg-gray-100 border-blue ",children:[o.jsx("button",{className:"px-8 py-4 text-2xl bg-blue text-white rounded-xl",type:"button",onClick:()=>i(!0),children:o.jsxs("span",{className:"whitespace-nowrap",children:[o.jsx(d,{className:"inline-block mx-3 mb-1",size:24}),"Generate a keypair"]})}),o.jsxs("p",{className:"pt-3 text-gray-400",children:["Use dabih to securely generate",o.jsx("br",{}),"your crypto keys in the browser"]})]}),o.jsx("div",{className:"m-2 h-80 sm:h-64",children:o.jsx(E,{onFile:g,onError:c=>t(c),maxSize:100*1024,children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"py-3 flex justify-center",children:o.jsxs("div",{className:"relative",children:[o.jsx(b,{className:"",size:66}),o.jsx(f,{className:"text-blue absolute inset-1 m-4 mt-6",strokeWidth:3,size:24})]})}),o.jsxs("button",{type:"button",className:"px-4 py-3 text-2xl rounded-xl text-white bg-blue inline-flex items-center",children:[o.jsx(b,{className:"mx-3"}),"Open public key file..."]}),o.jsx("p",{className:"pt-3 text-gray-400",children:"Add your own public key"})]})})})]})]})}export{B as default};
